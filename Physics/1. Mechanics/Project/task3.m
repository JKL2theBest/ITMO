%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Программа для получения графиков <x> и <x^2> в зависимости %
% от числа шагов, а так же соответствующие аппоксимирующие прямые %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Инициализация параметров
n = 500; 
dh = 0.02; 
y = 1:n; 
y = y';
x = zeros(size(y)); % Инициализация x-координаты каждой точки

% Массивы для хранения среднего и среднего квадратичного смещения
mean_disp = zeros(n,1);
mean_sq_disp = zeros(n,1);

% Бесконечный цикл для анимации
for i = 1:n
    x = x + dh*(2*rand(n,1)-1); 
    mean_disp(i) = mean(x); % Среднее смещение
    mean_sq_disp(i) = mean(x.^2); % Среднее квадратичное смещение
end

% Вычисление коэффициентов аппроксимирующих прямых
p1 = polyfit(1:n, mean_disp, 1);
p2 = polyfit(1:n, mean_sq_disp, 1);

% Построение графиков
figure;
subplot(2,1,1);
plot(1:n, mean_disp, 'b');
hold on;
plot(1:n, polyval(p1, 1:n), 'r--');
title('Среднее смещение');
xlabel('Шаги');
ylabel('<x>');

subplot(2,1,2);
plot(1:n, mean_sq_disp, 'b');
hold on;
plot(1:n, polyval(p2, 1:n), 'r--');
title('Среднее квадратичное смещение');
xlabel('Шаги');
ylabel('<x^2>');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%