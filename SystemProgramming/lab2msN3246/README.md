# Lab2: TCP Client-Server Application for Floating-Point Rounding

## Описание

Клиент-серверное приложение на языке C для ОС Linux, реализующее взаимодействие по TCP с использованием пользовательского протокола округления чисел. Сервер реализован с использованием многопроцессной модели обработки (через `fork()`).

## Компоненты

- **Сервер (`lab2msN3246_server`)**
  - Запускается на IP/порту (по умолчанию `127.0.0.1:7777`).
  - Обрабатывает соединения в многопроцессном режиме.
  - Принимает от клиента две строки:
    - первая — список вещественных чисел (разделители: пробелы, табуляции),
    - вторая — режим округления:  
      - `FLOOR` (вниз),  
      - `CEIL` (вверх),  
      - `TRUNC` (в сторону нуля).
  - Отправляет строку с округленными числами либо сообщение об ошибке `ERROR N`.
  - Поддерживает:
    - логирование в файл (через `-l` или переменную `LAB2LOGFILE`),
    - работу в режиме демона (`-d`),
    - отладочный режим (`LAB2DEBUG`),
    - корректную обработку сигналов и завершение процессов.

- **Клиент (`lab2msN3246_client`)**
  - Подключается к серверу по IP/порту.
  - Отправляет строки с числами и режимом округления.
  - Получает и отображает ответ.
  - Поддерживает те же опции конфигурации, что и сервер.

## Опции и переменные окружения

| Ключ            | Переменная      | Назначение                                | По умолчанию         | Компонент         |
|-----------------|-----------------|-------------------------------------------|-----------------------|-------------------|
| `-a <ip>`       | `LAB2ADDR`      | IP-адрес сервера                          | `127.0.0.1`           | Клиент, Сервер    |
| `-p <port>`     | `LAB2PORT`      | TCP-порт                                  | `7777`                | Клиент, Сервер    |
| `-w <N>`        | `LAB2WAIT`      | Задержка обработки клиента (сек)          | `0`                   | Сервер            |
| `-d`            |                 | Режим демона                              |                       | Сервер            |
| `-l <path>`     | `LAB2LOGFILE`   | Путь к лог-файлу                           | `/tmp/lab2.log`       | Сервер            |
| `-v`            |                 | Вывод версии                              |                       | Клиент, Сервер    |
| `-h`            |                 | Справка                                   |                       | Клиент, Сервер    |
|                 | `LAB2DEBUG`     | Включить отладочные сообщения             |                       | Клиент, Сервер    |

## Протокол

- **Запрос от клиента**:  

```
<числа через пробел или табуляцию>\n
<режим округления: FLOOR | CEIL | TRUNC>\n
```

- **Ответ от сервера**:  

```
<округленные числа через пробел>\n
```
или  
```
ERROR N\n
```

## Сборка

```bash
make all
```

## Makefile
```
CC = gcc
CFLAGS = -Wall -Wextra -Werror -O3
LDFLAGS = -lm
TARGETS = lab2msN3246_client lab2msN3246_server

.PHONY: all clean

all: $(TARGETS)

%: %.c
  $(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

clean:
  rm -f $(TARGETS)
```

## Пример запуска
Сервер (демон с логом):
```
./lab2msN3246_server -d -l /tmp/lab2.log -a 127.0.0.1 -p 7777
```
Клиент:
```
./lab2msN3246_client -a 127.0.0.1 -p 7777
```
Ввод:
```
1.5 2.6e0 -3.2
FLOOR
```
Вывод:
```
1 2 -4
```
## Требования
- ОС: Linux

- Компилятор: GCC (C99+)

- Инструменты: make, valgrind (для тестирования)

- Библиотеки: libm, libc